CREATE OR REPLACE FUNCTION WEEKDAY(a_date IN DATE)
    RETURNS SMALLINT AS
$$
BEGIN
    RETURN CAST(TO_CHAR(a_date, 'D') AS SMALLINT);
END;
$$ LANGUAGE PLPGSQL;
